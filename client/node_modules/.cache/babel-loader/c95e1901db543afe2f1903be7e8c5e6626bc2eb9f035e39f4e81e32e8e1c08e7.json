{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{jwtDecode}from'jwt-decode';import'./Auth.scss';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";const AuthComponent=()=>{const[formData,setFormData]=useState({username:'',password:''});const[user,setUser]=useState(null);const[isLoginFormVisible,setIsLoginFormVisible]=useState(false);const[isRegisterFormVisible,setIsRegisterFormVisible]=useState(false);useEffect(()=>{const storedToken=localStorage.getItem('authToken');const logoutUser=()=>{setUser(null);localStorage.removeItem('authToken');};if(storedToken){try{const decodedToken=jwtDecode(storedToken);const currentTime=Date.now()/1000;if(decodedToken.exp<currentTime){logoutUser();}else{setUser({username:decodedToken.username});}}catch(error){console.error('Error decoding token:',error);logoutUser();}}},[]);const handleAuth=async()=>{try{const endpoint=isRegisterFormVisible?'http://localhost:5000/auth/register':'http://localhost:5000/auth/login';const response=await axios.post(endpoint,formData);setUser(response.data.user);localStorage.setItem('authToken',response.data.token);setFormData({username:'',password:''});window.location.reload();}catch(error){console.error(\"Error during \".concat(isRegisterFormVisible?'registration':'login',\":\"),error);}};const handleLogout=()=>{setUser(null);localStorage.removeItem('authToken');window.location.reload();};const toggleLoginFormVisibility=()=>{setIsRegisterFormVisible(false);setIsLoginFormVisible(!isLoginFormVisible);};const toggleRegisterFormVisibility=()=>{setIsLoginFormVisible(false);setIsRegisterFormVisible(!isRegisterFormVisible);};return/*#__PURE__*/_jsx(\"div\",{className:\"auth-container\",children:user?/*#__PURE__*/_jsxs(\"div\",{className:\"auth__welcome-message\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Welcome, \",user.username]}),/*#__PURE__*/_jsx(\"button\",{className:\"auth-button\",onClick:handleLogout,children:\"Logout\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"auth-content\",children:[isLoginFormVisible&&/*#__PURE__*/_jsxs(\"div\",{className:\"auth-form\",children:[/*#__PURE__*/_jsx(\"label\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.username,onChange:e=>setFormData({...formData,username:e.target.value}),placeholder:\"Username\"})}),/*#__PURE__*/_jsx(\"label\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:formData.password,onChange:e=>setFormData({...formData,password:e.target.value}),placeholder:\"Password\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"auth-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"auth-button\",onClick:handleAuth,children:\"Login\"}),/*#__PURE__*/_jsx(\"div\",{className:\"auth-message\",onClick:toggleRegisterFormVisibility,children:\"Register\"})]})]}),isRegisterFormVisible&&/*#__PURE__*/_jsxs(\"div\",{className:\"auth-form\",children:[/*#__PURE__*/_jsx(\"label\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.username,onChange:e=>setFormData({...formData,username:e.target.value}),placeholder:\"Username\"})}),/*#__PURE__*/_jsx(\"label\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:formData.password,onChange:e=>setFormData({...formData,password:e.target.value}),placeholder:\"Password\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"auth-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"auth-button\",onClick:handleAuth,children:\"Register\"}),/*#__PURE__*/_jsx(\"div\",{className:\"auth-message\",onClick:toggleRegisterFormVisibility,children:\"Back\"})]})]}),!isLoginFormVisible&&!isRegisterFormVisible&&/*#__PURE__*/_jsx(\"div\",{className:\"auth-options\",children:/*#__PURE__*/_jsx(\"div\",{className:\"auth-message initial\",onClick:toggleLoginFormVisibility,children:\"Login\"})})]})});};export default AuthComponent;","map":{"version":3,"names":["React","useState","useEffect","axios","jwtDecode","jsxs","_jsxs","jsx","_jsx","AuthComponent","formData","setFormData","username","password","user","setUser","isLoginFormVisible","setIsLoginFormVisible","isRegisterFormVisible","setIsRegisterFormVisible","storedToken","localStorage","getItem","logoutUser","removeItem","decodedToken","currentTime","Date","now","exp","error","console","handleAuth","endpoint","response","post","data","setItem","token","window","location","reload","concat","handleLogout","toggleLoginFormVisibility","toggleRegisterFormVisibility","className","children","onClick","type","value","onChange","e","target","placeholder"],"sources":["/Users/adamrathbun/Desktop/cinema-chef/client/src/components/Auth/Auth.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { jwtDecode } from 'jwt-decode';\nimport './Auth.scss';\n\nconst AuthComponent = () => {\n  const [formData, setFormData] = useState({\n    username: '',\n    password: '',\n  });\n  const [user, setUser] = useState(null);\n  const [isLoginFormVisible, setIsLoginFormVisible] = useState(false);\n  const [isRegisterFormVisible, setIsRegisterFormVisible] = useState(false);\n\n  useEffect(() => {\n    const storedToken = localStorage.getItem('authToken');\n\n    const logoutUser = () => {\n      setUser(null);\n      localStorage.removeItem('authToken');\n    };\n\n    if (storedToken) {\n      try {\n        const decodedToken = jwtDecode(storedToken);\n        const currentTime = Date.now() / 1000;\n\n        if (decodedToken.exp < currentTime) {\n          logoutUser();\n        } else {\n          setUser({ username: decodedToken.username });\n        }\n      } catch (error) {\n        console.error('Error decoding token:', error);\n        logoutUser();\n      }\n    }\n  }, []);\n\n  const handleAuth = async () => {\n    try {\n      const endpoint = isRegisterFormVisible\n        ? 'http://localhost:5000/auth/register'\n        : 'http://localhost:5000/auth/login';\n\n      const response = await axios.post(endpoint, formData);\n      setUser(response.data.user);\n\n      localStorage.setItem('authToken', response.data.token);\n      setFormData({ username: '', password: '' });\n      window.location.reload();\n    } catch (error) {\n      console.error(`Error during ${isRegisterFormVisible ? 'registration' : 'login'}:`, error);\n    }\n  };\n\n  const handleLogout = () => {\n    setUser(null);\n    localStorage.removeItem('authToken');\n    window.location.reload();\n  };\n\n  const toggleLoginFormVisibility = () => {\n    setIsRegisterFormVisible(false);\n    setIsLoginFormVisible(!isLoginFormVisible);\n  };\n\n  const toggleRegisterFormVisibility = () => {\n    setIsLoginFormVisible(false);\n    setIsRegisterFormVisible(!isRegisterFormVisible);\n  };\n\n  return (\n    <div className=\"auth-container\">\n      {user ? (\n        <div className='auth__welcome-message'>\n          <p>Welcome, {user.username}</p>\n          <button className='auth-button' onClick={handleLogout}>Logout</button>\n        </div>\n      ) : (\n        <div className=\"auth-content\">\n          {isLoginFormVisible && (\n            <div className=\"auth-form\">\n              <label>\n                <input\n                  type=\"text\"\n                  value={formData.username}\n                  onChange={(e) => setFormData({ ...formData, username: e.target.value })}\n                  placeholder='Username'\n                />\n              </label>\n              <label>\n                <input\n                  type=\"password\"\n                  value={formData.password}\n                  onChange={(e) => setFormData({ ...formData, password: e.target.value })}\n                  placeholder='Password'\n                />\n              </label>\n              <div className=\"auth-buttons\">\n                <button className=\"auth-button\" onClick={handleAuth}>Login</button>\n                <div className=\"auth-message\" onClick={toggleRegisterFormVisibility}>Register</div>\n              </div>\n            </div>\n          )}\n          {isRegisterFormVisible && (\n            <div className=\"auth-form\">\n              <label>\n                <input\n                  type=\"text\"\n                  value={formData.username}\n                  onChange={(e) => setFormData({ ...formData, username: e.target.value })}\n                  placeholder='Username'\n                />\n              </label>\n              <label>\n                <input\n                  type=\"password\"\n                  value={formData.password}\n                  onChange={(e) => setFormData({ ...formData, password: e.target.value })}\n                  placeholder='Password'\n                />\n              </label>\n              <div className=\"auth-buttons\">\n                <button className=\"auth-button\" onClick={handleAuth}>Register</button>\n                <div className=\"auth-message\" onClick={toggleRegisterFormVisibility}>Back</div>\n              </div>\n            </div>\n          )}\n          {!isLoginFormVisible && !isRegisterFormVisible && (\n            <div className=\"auth-options\">\n              <div className=\"auth-message initial\" onClick={toggleLoginFormVisibility}>Login</div>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default AuthComponent;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,SAAS,KAAQ,YAAY,CACtC,MAAO,aAAa,CAAC,OAAAC,IAAA,IAAAC,KAAA,gCAAAC,GAAA,IAAAC,IAAA,yBAErB,KAAM,CAAAC,aAAa,CAAGA,CAAA,GAAM,CAC1B,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGV,QAAQ,CAAC,CACvCW,QAAQ,CAAE,EAAE,CACZC,QAAQ,CAAE,EACZ,CAAC,CAAC,CACF,KAAM,CAACC,IAAI,CAAEC,OAAO,CAAC,CAAGd,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACe,kBAAkB,CAAEC,qBAAqB,CAAC,CAAGhB,QAAQ,CAAC,KAAK,CAAC,CACnE,KAAM,CAACiB,qBAAqB,CAAEC,wBAAwB,CAAC,CAAGlB,QAAQ,CAAC,KAAK,CAAC,CAEzEC,SAAS,CAAC,IAAM,CACd,KAAM,CAAAkB,WAAW,CAAGC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,CAErD,KAAM,CAAAC,UAAU,CAAGA,CAAA,GAAM,CACvBR,OAAO,CAAC,IAAI,CAAC,CACbM,YAAY,CAACG,UAAU,CAAC,WAAW,CAAC,CACtC,CAAC,CAED,GAAIJ,WAAW,CAAE,CACf,GAAI,CACF,KAAM,CAAAK,YAAY,CAAGrB,SAAS,CAACgB,WAAW,CAAC,CAC3C,KAAM,CAAAM,WAAW,CAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAG,IAAI,CAErC,GAAIH,YAAY,CAACI,GAAG,CAAGH,WAAW,CAAE,CAClCH,UAAU,CAAC,CAAC,CACd,CAAC,IAAM,CACLR,OAAO,CAAC,CAAEH,QAAQ,CAAEa,YAAY,CAACb,QAAS,CAAC,CAAC,CAC9C,CACF,CAAE,MAAOkB,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAAC,CAC7CP,UAAU,CAAC,CAAC,CACd,CACF,CACF,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAS,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC7B,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAGf,qBAAqB,CAClC,qCAAqC,CACrC,kCAAkC,CAEtC,KAAM,CAAAgB,QAAQ,CAAG,KAAM,CAAA/B,KAAK,CAACgC,IAAI,CAACF,QAAQ,CAAEvB,QAAQ,CAAC,CACrDK,OAAO,CAACmB,QAAQ,CAACE,IAAI,CAACtB,IAAI,CAAC,CAE3BO,YAAY,CAACgB,OAAO,CAAC,WAAW,CAAEH,QAAQ,CAACE,IAAI,CAACE,KAAK,CAAC,CACtD3B,WAAW,CAAC,CAAEC,QAAQ,CAAE,EAAE,CAAEC,QAAQ,CAAE,EAAG,CAAC,CAAC,CAC3C0B,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC,CAC1B,CAAE,MAAOX,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,iBAAAY,MAAA,CAAiBxB,qBAAqB,CAAG,cAAc,CAAG,OAAO,MAAKY,KAAK,CAAC,CAC3F,CACF,CAAC,CAED,KAAM,CAAAa,YAAY,CAAGA,CAAA,GAAM,CACzB5B,OAAO,CAAC,IAAI,CAAC,CACbM,YAAY,CAACG,UAAU,CAAC,WAAW,CAAC,CACpCe,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC,CAC1B,CAAC,CAED,KAAM,CAAAG,yBAAyB,CAAGA,CAAA,GAAM,CACtCzB,wBAAwB,CAAC,KAAK,CAAC,CAC/BF,qBAAqB,CAAC,CAACD,kBAAkB,CAAC,CAC5C,CAAC,CAED,KAAM,CAAA6B,4BAA4B,CAAGA,CAAA,GAAM,CACzC5B,qBAAqB,CAAC,KAAK,CAAC,CAC5BE,wBAAwB,CAAC,CAACD,qBAAqB,CAAC,CAClD,CAAC,CAED,mBACEV,IAAA,QAAKsC,SAAS,CAAC,gBAAgB,CAAAC,QAAA,CAC5BjC,IAAI,cACHR,KAAA,QAAKwC,SAAS,CAAC,uBAAuB,CAAAC,QAAA,eACpCzC,KAAA,MAAAyC,QAAA,EAAG,WAAS,CAACjC,IAAI,CAACF,QAAQ,EAAI,CAAC,cAC/BJ,IAAA,WAAQsC,SAAS,CAAC,aAAa,CAACE,OAAO,CAAEL,YAAa,CAAAI,QAAA,CAAC,QAAM,CAAQ,CAAC,EACnE,CAAC,cAENzC,KAAA,QAAKwC,SAAS,CAAC,cAAc,CAAAC,QAAA,EAC1B/B,kBAAkB,eACjBV,KAAA,QAAKwC,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBvC,IAAA,UAAAuC,QAAA,cACEvC,IAAA,UACEyC,IAAI,CAAC,MAAM,CACXC,KAAK,CAAExC,QAAQ,CAACE,QAAS,CACzBuC,QAAQ,CAAGC,CAAC,EAAKzC,WAAW,CAAC,CAAE,GAAGD,QAAQ,CAAEE,QAAQ,CAAEwC,CAAC,CAACC,MAAM,CAACH,KAAM,CAAC,CAAE,CACxEI,WAAW,CAAC,UAAU,CACvB,CAAC,CACG,CAAC,cACR9C,IAAA,UAAAuC,QAAA,cACEvC,IAAA,UACEyC,IAAI,CAAC,UAAU,CACfC,KAAK,CAAExC,QAAQ,CAACG,QAAS,CACzBsC,QAAQ,CAAGC,CAAC,EAAKzC,WAAW,CAAC,CAAE,GAAGD,QAAQ,CAAEG,QAAQ,CAAEuC,CAAC,CAACC,MAAM,CAACH,KAAM,CAAC,CAAE,CACxEI,WAAW,CAAC,UAAU,CACvB,CAAC,CACG,CAAC,cACRhD,KAAA,QAAKwC,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BvC,IAAA,WAAQsC,SAAS,CAAC,aAAa,CAACE,OAAO,CAAEhB,UAAW,CAAAe,QAAA,CAAC,OAAK,CAAQ,CAAC,cACnEvC,IAAA,QAAKsC,SAAS,CAAC,cAAc,CAACE,OAAO,CAAEH,4BAA6B,CAAAE,QAAA,CAAC,UAAQ,CAAK,CAAC,EAChF,CAAC,EACH,CACN,CACA7B,qBAAqB,eACpBZ,KAAA,QAAKwC,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxBvC,IAAA,UAAAuC,QAAA,cACEvC,IAAA,UACEyC,IAAI,CAAC,MAAM,CACXC,KAAK,CAAExC,QAAQ,CAACE,QAAS,CACzBuC,QAAQ,CAAGC,CAAC,EAAKzC,WAAW,CAAC,CAAE,GAAGD,QAAQ,CAAEE,QAAQ,CAAEwC,CAAC,CAACC,MAAM,CAACH,KAAM,CAAC,CAAE,CACxEI,WAAW,CAAC,UAAU,CACvB,CAAC,CACG,CAAC,cACR9C,IAAA,UAAAuC,QAAA,cACEvC,IAAA,UACEyC,IAAI,CAAC,UAAU,CACfC,KAAK,CAAExC,QAAQ,CAACG,QAAS,CACzBsC,QAAQ,CAAGC,CAAC,EAAKzC,WAAW,CAAC,CAAE,GAAGD,QAAQ,CAAEG,QAAQ,CAAEuC,CAAC,CAACC,MAAM,CAACH,KAAM,CAAC,CAAE,CACxEI,WAAW,CAAC,UAAU,CACvB,CAAC,CACG,CAAC,cACRhD,KAAA,QAAKwC,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BvC,IAAA,WAAQsC,SAAS,CAAC,aAAa,CAACE,OAAO,CAAEhB,UAAW,CAAAe,QAAA,CAAC,UAAQ,CAAQ,CAAC,cACtEvC,IAAA,QAAKsC,SAAS,CAAC,cAAc,CAACE,OAAO,CAAEH,4BAA6B,CAAAE,QAAA,CAAC,MAAI,CAAK,CAAC,EAC5E,CAAC,EACH,CACN,CACA,CAAC/B,kBAAkB,EAAI,CAACE,qBAAqB,eAC5CV,IAAA,QAAKsC,SAAS,CAAC,cAAc,CAAAC,QAAA,cAC3BvC,IAAA,QAAKsC,SAAS,CAAC,sBAAsB,CAACE,OAAO,CAAEJ,yBAA0B,CAAAG,QAAA,CAAC,OAAK,CAAK,CAAC,CAClF,CACN,EACE,CACN,CACE,CAAC,CAEV,CAAC,CAED,cAAe,CAAAtC,aAAa"},"metadata":{},"sourceType":"module","externalDependencies":[]}